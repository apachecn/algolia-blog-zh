<html>
<head>
<title>Building a Store Locator in React using Algolia, Mapbox, and Twilio â€“ Part 2 | Algolia Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Algoliaã€Mapboxå’ŒTwilioåœ¨Reactä¸­æ„å»ºå•†åº—å®šä½å™¨â€”â€”ç¬¬2éƒ¨åˆ†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://www.algolia.com/blog/engineering/building-a-store-locator-in-react-using-algolia-mapbox-and-twilio-part-2/#0001-01-01">https://www.algolia.com/blog/engineering/building-a-store-locator-in-react-using-algolia-mapbox-and-twilio-part-2/#0001-01-01</a></blockquote><div><div class="css-t54cg4"><p class="c9 translated">è¿™æ˜¯æˆ‘ä»¬å…³äºæ„å»ºå•†åº—å®šä½å™¨çš„3éƒ¨åˆ†å®æ—¶ç¼–ç ç³»åˆ—çš„ç¬¬äºŒç¯‡æ–‡ç« ã€‚è¯·åŠ¡å¿…æŸ¥çœ‹<span class="c3"> <a class="c22" href="https://www.algolia.com/blog/engineering/building-a-store-locator-in-react-using-algolia-mapbox-and-twilio-part-1/">æ„å»ºå•†åº—å®šä½å™¨-ç¬¬1éƒ¨åˆ†</a> </span>å’Œ<span class="c3"> <a class="c22" href="https://www.algolia.com/blog/engineering/building-a-store-locator-in-react-using-algolia-mapbox-and-twilio-part-3/">æ„å»ºå•†åº—å®šä½å™¨-ç¬¬3éƒ¨åˆ†</a> </span>ã€‚</p>
<p class="c31 c41 c21 translated"><span class="c0">å¦‚ä»Šï¼Œç”µå­å•†åŠ¡è´­ç‰©è€…æœŸæœ›ä¾¿åˆ©ï¼Œå¸Œæœ›ç°å®ä¸–ç•Œå’Œç½‘ç»œä¸–ç•Œèåˆï¼Œå…è®¸ä»–ä»¬é€šè¿‡ä»»ä½•æ¸ é“å¼€å±•ä¸šåŠ¡ã€‚è¿™å°±æ˜¯å•†åº—å®šä½å™¨çš„ç”¨é€”ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥:</span></p>
<ul>
<li class="translated">åœ¨çº¿æœç´¢äº§å“ï¼Œç„¶ååœ¨åº—å†…è´­ä¹°</li>
<li class="translated">äº²è‡ªæµè§ˆå’Œæ¯”è¾ƒäº§å“ï¼Œç„¶ååœ¨çº¿è´­ä¹°</li>
<li class="translated">åœ¨çº¿è´­ç‰©å’Œè´­ä¹°äº§å“ï¼Œç„¶åäº²è‡ªæè´§</li>
<li class="translated">äº²è‡ªé€€è¿˜ä¹‹å‰è´­ä¹°çš„ç‰©å“ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬å¯„å›</li>
</ul>
<p class="translated">å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å¤ªå¤šçš„ç½‘ç«™æ²¡æœ‰ä¸ºç”¨æˆ·æä¾›ä¸€ç§ä¼˜é›…çš„æ–¹å¼æ¥æ‰¾åˆ°ä»–ä»¬çš„â€œæœ€è¿‘çš„å•†åº—â€ï¼Œæ— è®ºæ˜¯åœ¨çº¿æµ‹è¯•æˆ–è´­ä¹°ï¼Œè¿˜æ˜¯åœ¨çº¿è´­ä¹°ã€‚</p>
<p class="translated">æ„å»ºå•†åº—å®šä½å™¨ä¼¼ä¹å¾ˆå¤æ‚ï¼Œå› ä¸ºå®ƒéœ€è¦å®ç°åœ°ç†æœç´¢ã€åœ°å€/å…´è¶£ç‚¹(POI)æœç´¢ï¼Œå¹¶åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºç»“æœã€‚ä¸ºäº†è®©æ¯ä¸ªäººéƒ½å°½å¯èƒ½å®¹æ˜“åœ°è·Ÿä¸Šï¼Œæˆ‘ä»¬å†³å®šåœ¨ä¸‰ç¯‡åšå®¢æ–‡ç« ä¹‹åè¿›è¡Œä¸€ç³»åˆ—çš„ä¸‰æ¬¡ç°åœºç¼–ç ä¼šè®®ã€‚åœ¨è¿™äº›äº‹ä»¶ä¸­ï¼Œæˆ‘ä»¬å†³å®šåœ¨React ä¸­åˆ›å»ºä¸€ä¸ªå“åº”å¼<i>å•†åº—å®šä½å™¨ï¼Œä½¿ç”¨:</i></p>
<ul>
<li class="translated"><a href="https://www.algolia.com/"> Algolia </a>çš„åœ°ç†æœç´¢åŠŸèƒ½ï¼›</li>
<li class="translated"><a href="https://www.mapbox.com/use-cases/store-locator">åœ°å›¾æ¡†</a>ç”¨äºæ˜¾ç¤ºåœ°å›¾å’Œæœç´¢ä½ç½®å’Œå…´è¶£ç‚¹</li>
<li class="translated"><a href="https://www.twilio.com/sms"> Twilio </a>ç”¨äºåœ¨è®¢å•å‡†å¤‡å°±ç»ªåå‘é€æ–‡æœ¬</li>
<li class="translated"><a href="https://www.clever-cloud.com/en/">é¢–äº‘</a>ä¸»æŒ</li>
</ul>
<p class="translated">ä½¿ç”¨React v17ã€<a href="https://www.algolia.com/doc/guides/building-search-ui/what-is-instantsearch/react/"> React InstantSearch </a>å’Œ<a href="https://github.com/algolia/autocomplete"> Autocomplete </a> UIåº“åŒ…è£…ä¸€åˆ‡ï¼Œåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…æ„å»ºç°ä»£æœç´¢å’Œå‘ç°ä½“éªŒã€‚</p>
<p class="translated"><iframe src="https://www.youtube.com/embed/jyntg6hkKMs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen">è§†é¢‘</iframe></p>
<p class="translated">æ³¨æ„:åœ¨ç¬¬1éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†æ‰€æœ‰å¿…éœ€çš„å¸æˆ·(Clever cloudå’ŒAlgolia)ï¼Œæˆ‘ä»¬ç´¢å¼•äº†æ•°æ®ï¼Œå¹¶é…ç½®äº†Algoliaç´¢å¼•ã€‚<a href="https://www.algolia.com/blog/engineering/building-a-store-locator-in-react-using-algolia-mapbox-and-twilio-part-1/">é˜…è¯»ç¬¬1éƒ¨åˆ†</a></p>
<h1 class="translated"><a id="adding-geo-search-capabilities" class="anchor" href="#adding-geo-search-capabilities" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>æ·»åŠ åœ°ç†æœç´¢åŠŸèƒ½</h1>
<p class="translated">ä¸ºäº†å¿«é€Ÿæ‰¾åˆ°è·ç¦»æˆ‘ä»¬å½“å‰ä½ç½®æˆ–ç»™å®šåœ°å€è¾“å…¥æœ€è¿‘çš„å•†åº—ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨<a href="https://www.algolia.com/doc/guides/building-search-ui/ui-and-ux-patterns/geo-search/react/"> Algoliaåœ°ç†æœç´¢åŠŸèƒ½</a>ï¼Œä»¥åŠ<a href="https://www.algolia.com/doc/guides/building-search-ui/what-is-instantsearch/react/"> React InstantSearch </a>ï¼Œåœ¨åˆ—è¡¨è§†å›¾å’Œåœ°å›¾è§†å›¾ä¸Šæ˜¾ç¤ºæ‰¾åˆ°çš„å•†åº—(ä½¿ç”¨Mapbox GL)ã€‚</p>
<p class="translated"><span>æ³¨</span>:ä½ å¯ä»¥åœ¨é¡¹ç›®çš„<a href="https://github.com/algolia-samples/store-locator-with-algolia-mapbox-twilio/tree/session-2-adding-instant-search-start"> Githubèµ„æºåº“</a>ä¸­æ‰¾åˆ°ç¬¬1éƒ¨åˆ†æœ«å°¾è·å¾—çš„ä»£ç ã€‚</p>
<h2 class="translated"><a id="a-quick-overview-of-algolia%e2%80%99s-instantsearch" class="anchor" href="#a-quick-overview-of-algolia%e2%80%99s-instantsearch" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Algoliaçš„å³æ—¶æœç´¢å¿«é€Ÿæ¦‚è¿°</h2>
<p class="translated">React InstantSearchæ˜¯Reactçš„ä¸€ä¸ªå¼€æºã€ç”Ÿäº§å°±ç»ªçš„UIåº“(ä¹Ÿæœ‰VanillaJSã€Vueã€Angularã€Swiftå’ŒKotlinç‰ˆæœ¬)ï¼Œå®ƒå…è®¸æ‚¨åœ¨å‰ç«¯åº”ç”¨ç¨‹åºä¸­å¿«é€Ÿæ„å»ºæœç´¢ç•Œé¢ã€‚</p>
<p class="translated">å®ƒçš„ç›®æ ‡æ˜¯é€šè¿‡æä¾›ä¸€ä¸ª<a href="https://www.algolia.com/doc/guides/getting-started/how-algolia-works/#the-full-ecosystem">å®Œæ•´çš„æœç´¢ç”Ÿæ€ç³»ç»Ÿ</a>æ¥å¸®åŠ©ä½ å°½å¯èƒ½é¡ºåˆ©åœ°å®ç°ä»¤äººæ•¬ç•çš„æœç´¢ä½“éªŒã€‚InstantSearché€šè¿‡æä¾›ç§°ä¸ºâ€œå°éƒ¨ä»¶â€çš„å‰ç«¯UIç»„ä»¶è§£å†³äº†è¿™ä¸€å·¨å¤§ç›®æ ‡çš„é‡è¦éƒ¨åˆ†ï¼Œæ‚¨å¯ä»¥å°†è¿™äº›ç»„ä»¶ç»„è£…åˆ°ç‹¬ç‰¹çš„æœç´¢ç•Œé¢ä¸­ï¼Œä¾‹å¦‚:</p>

<p class="translated">åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨ä¸€äº›ç°æœ‰çš„å°éƒ¨ä»¶ï¼Œå¦‚<a href="https://www.algolia.com/doc/api-reference/widgets/infinite-hits/react/">infini hits</a>å’Œ<a href="https://www.algolia.com/doc/api-reference/widgets/refinement-list/react/"> RefinementList </a>ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå®šåˆ¶çš„å°éƒ¨ä»¶ï¼Œä»¥ä¾¿åœ¨Mapboxæ”¯æŒçš„åœ°å›¾ä¸Šæ˜¾ç¤ºç»“æœã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†æ‰©å±•é»˜è®¤çš„åœ°ç†æœç´¢å°éƒ¨ä»¶ï¼Œå®ƒé»˜è®¤ä½¿ç”¨è°·æ­Œåœ°å›¾ï¼Œä½†ç”±äºæœ‰äº†<a href="https://www.algolia.com/doc/api-reference/widgets/geo-search/react/#connector"> connectGeoSearchè¿æ¥å™¨</a>ï¼Œå®ƒå¯ä»¥è¢«æ‰©å±•ã€‚</p>
<p class="translated">æ³¨æ„:é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact InstantSearchä¸<a href="https://www.algolia.com/doc/guides/building-search-ui/going-further/server-side-rendering/react/">æœåŠ¡å™¨ç«¯æ¸²æŸ“</a>å…¼å®¹ï¼Œå¹¶å…·æœ‰<a href="https://www.algolia.com/doc/guides/building-search-ui/going-further/routing-urls/react/">å®Œå…¨è·¯ç”±èƒ½åŠ›</a>ã€‚</p>
<h2 class="translated"><a id="adding-react-instantsearch-to-our-app" class="anchor" href="#adding-react-instantsearch-to-our-app" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>å‘æˆ‘ä»¬çš„åº”ç”¨æ·»åŠ React InstantSearch</h2>
<p class="translated">è¦å°†InstantSearchæ·»åŠ åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œè®©æˆ‘ä»¬å®‰è£…æ‰€éœ€çš„åŒ…ã€‚</p>
<pre class="lang:sh decode:true">yarn add algoliasearch react-instantsearch-dom</pre>
<p class="translated">ä¸ºäº†ç±»å‹è„šæœ¬å…¼å®¹æ€§å’ŒIDEæ”¯æŒï¼Œæˆ‘ä»¬è¿˜å°†æ·»åŠ <b> react-instantsearch </b>ç±»å‹</p>
<p>Â </p>
<pre class="lang:sh decode:true ">yarn add -D @types/react-instantsearch</pre>
<p>Â </p>
<p class="translated">å¯¹äºæœ¬æŒ‡å—çš„è¿™ä¸€éƒ¨åˆ†ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å…¨éƒ¨å†…å®¹ã€‚</p>
<p class="translated">æˆ‘ä»¬å…ˆä»Algoliaçš„ä»ªè¡¨ç›˜ä¸ŠæŠ“å–ä¸€äº›ä¿¡æ¯ã€‚</p>
<p class="translated">åœ¨Algoliaä»ªè¡¨ç›˜ä¸Šï¼Œç‚¹å‡»<b>å¹³å°</b>å›¾æ ‡(ä¾§æ ä¸­çš„æœ€åä¸€ä¸ªå›¾æ ‡)å¹¶é€‰æ‹©<b> APIå¯†é’¥</b>ä»¥å¤åˆ¶æ‚¨çš„ä»…æœç´¢APIå¯†é’¥å’Œåº”ç”¨IDã€‚</p>
<p class="translated"><img loading="lazy" class="aligncenter wp-image-12477 size-full" src="../Images/4dfb7793403361e453fd5e42eae7f717.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image5.png 1999w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image5-259x178.png 259w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image5-581x400.png 581w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image5-768x529.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image5-1536x1057.png 1536w" sizes="(max-width: 1999px) 100vw, 1999px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image5.png"/></p>
<p class="translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º<code>.local.env</code>çš„æ–‡ä»¶ã€‚æˆ‘ä»¬å°†æŠŠç¯å¢ƒå˜é‡å­˜å‚¨åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚è¿™äº›å˜é‡å°†åœ¨æ„å»ºæ—¶æ³¨å…¥åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ‰€ä»¥ä¸è¦å¿˜è®°åœ¨åˆ›å»ºè¿™ä¸ªæ–‡ä»¶åé‡å¯æœ¬åœ°å¼€å‘æœåŠ¡å™¨ã€‚</p>
<p class="translated">å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°<code>.local.env</code>æ–‡ä»¶ä¸­:</p>
<pre class="lang:sh decode:true">REACT_APP_ALGOLIA_APP_ID=â€myAppIdâ€&#13;
REACT_APP_ALGOLIA_API_KEY=â€xxxxxâ€&#13;
REACT_APP_ALGOLIA_INDEX_NAME=â€myIndiceNameâ€&#13;
</pre>
<p class="translated">æ³¨æ„:å¦‚æœç¯å¢ƒå˜é‡å¯¹ä½ æ¥è¯´æ˜¯æ–°çš„ï¼Œæœ‰å¾ˆå¤šéå¸¸å¥½çš„èµ„æºï¼Œæ¯”å¦‚:æˆ‘çš„æœ‹å‹å¼ ç§€å¤Twilioçš„é¦–å¸­å¼€å‘äººå‘˜å¸ƒé“è€…â€”â€”å†™çš„ã€Šåœ¨Node.jsä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡ã€‹,å¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿäº†è§£è¿™ä¸ªä¸»é¢˜ã€‚å¦ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­é›†ä¸­åœ¨<a href="https://create-react-app.dev/docs/adding-custom-environment-variables/">åœ¨Create React Appåº”ç”¨ç¨‹åºä¸­æ·»åŠ è‡ªå®šä¹‰ç¯å¢ƒå˜é‡</a>ã€‚</p>
<h3 class="translated"><a id="creating-the-algolia-client-instance" class="anchor" href="#creating-the-algolia-client-instance" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a> <b>åˆ›å»ºAlgoliaå®¢æˆ·ç«¯å®ä¾‹</b></h3>
<p class="translated">ç°åœ¨æˆ‘ä»¬å·²ç»å®‰è£…äº†æ‰€éœ€çš„åŒ…ï¼Œè®©æˆ‘ä»¬å°†React InstantSearchæ·»åŠ åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ã€‚ç¬¬ä¸€æ­¥æ˜¯åœ¨æˆ‘ä»¬æ–‡ä»¶çš„é¡¶éƒ¨å¯¼å…¥InstantSearchã€‚</p>
<pre class="lang:js decode:true">import {&#13;
  InstantSearch,&#13;
} from 'react-instantsearch-dom';&#13;
</pre>
<p class="translated">ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†å³æ—¶æœç´¢ç»„ä»¶æ·»åŠ åˆ°ä»£ç ä¸­:</p>
<p class="translated"><img loading="lazy" class="alignnone wp-image-12540 size-full" src="../Images/c7ee501694daefb4e9f9376a39065957.png" alt="InstantSearch init code" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1.png 1712w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1-320x104.png 320w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1-720x234.png 720w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1-768x249.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1-1536x499.png 1536w" sizes="(max-width: 1712px) 100vw, 1712px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1.png"/></p>
<p class="translated">å¦‚æ‚¨æ‰€è§ï¼Œå®ƒéœ€è¦ä¸¤ä¸ªå‚æ•°:</p>
<ul>
<li class="translated"><b> <code>indexName</code> </b>æ˜¯æ‚¨æ”¾å…¥Algoliaä»ªè¡¨ç›˜çš„ç´¢å¼•åç§°ã€‚</li>
<li class="translated"><b> <code>searchClient</code> </b>æ˜¯AlgoliaSearchçš„ä¸€ä¸ªå®ä¾‹ï¼ŒAlgolia Search APIçš„JavaScriptå®¢æˆ·ç«¯åº“ï¼Œå®ƒå°†æ‰§è¡Œæ‰€æœ‰çš„è¯·æ±‚ã€‚ç”±äºæˆ‘ä»¬å¸Œæœ›å°½å¯èƒ½ç®€å•ï¼Œæˆ‘ä»¬å°†ä¸ºè¿™ä¸ªå®ä¾‹æ·»åŠ ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶(æ­¤å¤–ï¼Œæˆ‘ä»¬å°†åœ¨ç¬¬ä¸‰ä¸ªè§†é¢‘ä¸­éœ€è¦å®ƒï¼Œå¹¶ä¸”ä¿æŒäº‹ç‰©çš„åˆ†ç¦»åœ¨è½¯ä»¶å·¥ç¨‹ä¸­æ€»æ˜¯ä¸€ä¸ªå¥½çš„å®è·µ)ã€‚</li>
</ul>
<p class="translated"><i>src/lib/algolia client . ts</i></p>
<pre class="lang:js decode:true">import algoliaSearch from 'algoliasearch';&#13;
&#13;
const indexName = process.env.REACT_APP_ALGOLIA_INDEX_NAME;&#13;
const searchClient = algoliaSearch( process.env.REACT_APP_ALGOLIA_APP_ID as string, process.env.REACT_APP_ALGOLIA_API_KEY as string );&#13;
&#13;
export { indexName, searchClient };&#13;
</pre>
<p class="translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†æˆ‘ä»¬çš„å®¢æˆ·æœºï¼Œæ˜¯æ—¶å€™åœ¨æˆ‘ä»¬çš„InstantSearchå®ä¾‹ä¸­ä½¿ç”¨å®ƒäº†ã€‚</p>
<h3 class="translated"><a id="adding-our-first-widget-to-instantsearch" class="anchor" href="#adding-our-first-widget-to-instantsearch" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a> <b>å°†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå°éƒ¨ä»¶æ·»åŠ åˆ°å³æ—¶æœç´¢</b></h3>
<p class="translated"><img loading="lazy" class="alignnone wp-image-12540 size-full" src="../Images/c7ee501694daefb4e9f9376a39065957.png" alt="InstantSearch init code" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1.png 1712w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1-320x104.png 320w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1-720x234.png 720w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1-768x249.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1-1536x499.png 1536w" sizes="(max-width: 1712px) 100vw, 1712px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-1.png"/></p>
<p class="translated">æˆ‘ä»¬å°†ä½¿ç”¨<hits>å°éƒ¨ä»¶æ¥æ˜¾ç¤ºAlgoliaè¿”å›çš„ç»“æœã€‚</hits></p>
<p class="translated"><code>Hits</code>ç»„ä»¶åªæ¥å—ä¸€ä¸ªå±æ€§:<code>hitComponent</code>ï¼Œä¸€ä¸ªå¸¦æœ‰<b>é¡¹</b>ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œå®ƒåº”è¯¥è¿”å›JSXã€‚è¿™ä¸ªJSXå°†åœ¨åº”ç”¨ç¨‹åºä¸­å‘ˆç°ã€‚</p>
<pre class="lang:js decode:true ">&lt;Hits&lt;Hit&gt; hitComponent={&#13;
({ hit }) =&gt; (&#13;
      	&lt;StoreComponent&#13;
           	key={hit.objectID}&#13;
                onClick={(hit) =&gt; handleClick(hit)}&#13;
                hit={hit}&#13;
                currentStore={currentStoreCoordinates}&#13;
            /&gt;&#13;
      )}/&gt;&#13;
</pre>
<p class="translated">ä½ å¯ä»¥è¿”å›ä»»ä½•ä½ æƒ³è¦çš„JSXï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»åˆ›å»ºäº†è‡ªå·±çš„ç»„ä»¶ï¼Œå®ƒåªä¸è¿‡æ˜¯ä¸€ä¸ªå¸¦æœ‰ä¸€ç‚¹CSSçš„<code>div</code>ã€‚</p>
<p class="translated">è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£ä¸€ä¸‹å®ƒçš„é“å…·:</p>
<ul>
<li class="translated"><b>é”®å±æ€§</b>ç”¨äºå¸®åŠ©Reactè¯†åˆ«å®ƒå¿…é¡»å‘ˆç°çš„å¾ªç¯å…ƒç´ ã€‚ï¼Œå¦‚æœæ‚¨å¯¹Reactä¸å¤ªç†Ÿæ‚‰ï¼Œè¯·æŸ¥çœ‹å…³äº<a href="https://reactjs.org/docs/lists-and-keys.html#keys">åˆ—è¡¨å’Œé”®çš„æ–‡æ¡£â€”â€”React</a>:</li>
<li class="translated"><b> onClickå±æ€§</b>ç”¨äºå¤„ç†é¡¹ç›®ä¸Šçš„é¼ æ ‡äº‹ä»¶ã€‚ï¼›</li>
<li class="translated">ç‚¹å‡»é“å…·ç”¨äºå¡«å……ç»„ä»¶ã€‚</li>
<li class="translated">æœ€åï¼Œ<b> currentStoreå±æ€§</b>ç”¨äºè®©åº”ç”¨ç¨‹åºçŸ¥é“é€‰æ‹©äº†å“ªä¸ªå•†åº—ã€‚é€šè¿‡æ¯”è¾ƒä¸¤ä¸ªLngLatåæ ‡çš„æ¯”è¾ƒä½ç½®ï¼Œå°†pinæ›´æ”¹ä¸ºä¸åŒçš„é¢œè‰²(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­)ä¼šå¾ˆæœ‰ç”¨ã€‚</li>
</ul>
<p class="translated"><i>src/lib/compare position . ts</i></p>
<pre class="lang:js decode:true ">export const comparePosition = (&#13;
  position1: [number, number],&#13;
  position2: [number, number] | null&#13;
): boolean =&gt; {&#13;
  return position2&#13;
    ? position1[0] === position2[0] &amp;&amp; position1[1] === position2[1]&#13;
    : false;&#13;
};&#13;
&#13;
</pre>
<p class="translated">ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†è¿™ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬åº”è¯¥ä¼šåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ—è¾¹çœ‹åˆ°ä¸€ä¸ªæ¼‚äº®çš„æ–¯æ½˜å¡å•†åº—åˆ—è¡¨ï¼</p>
<p class="translated"><video poster="https://res.cloudinary.com/hilnmyskv/image/upload/v1626774743/blogposts/store_locator_2021_list_preview.jpg" autoplay="autoplay" loop="loop" muted="muted"> <source type="video/mp4" src="https://res.cloudinary.com/hilnmyskv/image/upload/v1626774743/blogposts/store_locator_2021_list_preview.mp4"/> <source type="video/webm" src="https://res.cloudinary.com/hilnmyskv/image/upload/v1626774743/blogposts/store_locator_2021_list_preview.webm"/> </video></p>
<p class="translated">ä½†äº‹å®æ˜¯:å®ƒå¹¶ä¸çœŸæ­£å¯ç”¨ã€‚å½“ç„¶ï¼Œå®ƒåšåˆ°äº†æˆ‘ä»¬è¦æ±‚çš„(æŒ‰å—æ¬¢è¿ç¨‹åº¦æ’åºï¼Œä½†ç”±äºæˆ‘ä½åœ¨æ³•å›½åŒ—éƒ¨(é è¿‘é‡Œå°”å’Œæ¯”åˆ©æ—¶â€”â€”ç¾å‘³çš„å·§å…‹åŠ›å’Œä¸Šå¥½çš„å•¤é…’)ï¼Œæˆ‘ç»å¯¹ä¸å…³å¿ƒäºšç‰¹å…°å¤§çš„å•†åº—ã€‚</p>
<p class="translated">å› æ­¤ï¼Œè®©æˆ‘ä»¬æ·»åŠ åœ°ç†æœç´¢åŠŸèƒ½ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥æ˜¾ç¤ºæˆ‘å‘¨å›´æœ€å—æ¬¢è¿çš„å•†åº—ï¼</p>
<h3 class="translated"><a id="adding-geo-search" class="anchor" href="#adding-geo-search" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a> <b>æ·»åŠ åœ°ç†æœç´¢</b></h3>
<p class="translated">é»˜è®¤æƒ…å†µä¸‹ï¼ŒAlgoliaæä¾›äº†æ‰§è¡Œåœ°ç†æœç´¢çš„å¯èƒ½æ€§ï¼Œæ— éœ€ä¼ é€’ä»»ä½•çº¬åº¦/ç»åº¦ï¼Œä½†ä»ä¼šè¿”å›æœ€è¿‘çš„å‘½ä¸­ç»“æœã€‚æ€ä¹ˆä¼šï¼Ÿå®ƒä¾èµ–äºä½ ç”¨æ¥è°ƒç”¨Algolia APIçš„IPåœ°å€ã€‚æ³¨æ„:å¯¹äºæ¬§ç›Ÿçš„äººï¼Œä»2021å¹´7æœˆèµ·ï¼ŒIPåœ°å€ä¸è¢«è§†ä¸ºPII(ä¸ªäººèº«ä»½ä¿¡æ¯ï¼Œæ³•è¯­ä¸­â€œDonnÃ©e Ã  caractÃ¨re personnelleâ€çš„DCP ),å› ä¸ºå®ƒä¸ç²¾ç¡®å®šä½ç”¨æˆ·ï¼Œè¿™æ„å‘³ç€ä¸éœ€è¦è­¦å‘Šç”¨æˆ·æ‚¨æ­£åœ¨ä½¿ç”¨å®ƒæ¥å‘Šè¯‰InstantSearchæˆ‘ä»¬æƒ³è¦ä½¿ç”¨â€œaroundLatLngViaIP â€,æˆ‘ä»¬ä½¿ç”¨é…ç½®ç»„ä»¶</p>
<p class="translated"><img loading="lazy" class="alignnone size-full wp-image-12546" src="../Images/98b91740045b97e6e0b92603efdf89e4.png" alt="InstantSearch ConfigureComponent" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-3.png 1714w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-3-320x78.png 320w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-3-720x176.png 720w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-3-768x187.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-3-1536x375.png 1536w" sizes="(max-width: 1714px) 100vw, 1714px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-3.png"/>æ³¨æ„:&lt;é…ç½®/ &gt;ç»„ä»¶å¯ä»¥æ¥å—ä»»ä½•<a href="https://www.algolia.com/doc/api-reference/widgets/configure/react/">æœç´¢å‚æ•°</a>ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€é›†çœ‹åˆ°æ›´å¤šã€‚</p>
<p class="translated">ç°åœ¨ï¼Œæ‚¨ä¼šçœ‹åˆ°åˆ—è¡¨æ˜¾ç¤ºäº†æ‚¨æ‰€åœ¨ä½ç½®é™„è¿‘çš„å•†åº—ã€‚æœ€ç®€å•çš„å®éªŒæ–¹æ³•æ˜¯é€šè¿‡VPNã€‚</p>
<table cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td colspan="2">
<p class="translated"><figure id="attachment_12474" aria-describedby="caption-attachment-12474" class="wp-caption aligncenter"> <img loading="lazy" class="wp-image-12474 size-large" src="../Images/f5d3baba0263058c89c5d2f00c85a361.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image1-206x400.png 206w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image1-92x178.png 92w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image1.png 724w" sizes="(max-width: 206px) 100vw, 206px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image1-206x400.png"/> <figcaption id="caption-attachment-12474" class="wp-caption-text">ä¸æˆ‘çš„å¸¸è§„è¿æ¥(ğŸ‡«ğŸ‡·) </figcaption> </figure></p></td>
<td colspan="2">
<p class="translated"><figure id="attachment_12480" aria-describedby="caption-attachment-12480" class="wp-caption aligncenter"> <img loading="lazy" class="wp-image-12480 size-large" src="../Images/dd6aab6bc5b098af0921c63ccc8a14ec.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image8-169x400.png 169w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image8-75x178.png 75w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image8-648x1536.png 648w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image8.png 724w" sizes="(max-width: 169px) 100vw, 169px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image8-169x400.png"/> <figcaption id="caption-attachment-12480" class="wp-caption-text">ç”¨VPNè¿æ¥åˆ°ä¸€ä¸ªå¸Œè…ŠæœåŠ¡å™¨(ğŸ‡¬ğŸ‡·)(å¤ªé˜³æ¥äº†ğŸµ)</figcaption> </figure></p></td>
</tr>
</tbody>
</table>
<p class="translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†é™„è¿‘å•†åº—çš„åˆ—è¡¨ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ¼‚äº®çš„<b>ç»†åŒ–åˆ—è¡¨</b>æ¥è¿‡æ»¤æœåŠ¡ç±»å‹ã€‚</p>
<p class="translated">ä¸<b> Hits </b>å°éƒ¨ä»¶ä¸åŒï¼Œ<b> RefinementList </b>ç»„ä»¶åªæœ‰ä¸€ä¸ªå±æ€§ï¼Œç”¨äºä¼ é€’æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„æ–¹é¢<b>å±æ€§</b>çš„åç§°ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨ç¬¬1éƒ¨åˆ†çš„<a href="https://www.algolia.com/blog/engineering/building-a-store-locator-in-react-using-algolia-mapbox-and-twilio-part-1/" target="_blank" rel="noopener">ä¸­çš„Algoliaä»ªè¡¨ç›˜ä¸­é…ç½®çš„ã€‚</a></p>
<p class="translated"><img loading="lazy" class="alignnone size-full wp-image-12547" src="../Images/cc8be5febb2fd32b161d12df585ddbe4.png" alt="InstantSearch Refinement list config" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-4.png 1714w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-4-320x78.png 320w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-4-720x176.png 720w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-4-768x187.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-4-1536x375.png 1536w" sizes="(max-width: 1714px) 100vw, 1714px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/carbon-4.png"/></p>
<h3 class="translated"><a id="styling-of-the-refinementlist" class="anchor" href="#styling-of-the-refinementlist" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a> <b>ç»†åŒ–åˆ—è¡¨çš„æ ·å¼</b></h3>
<p class="translated">Algoliaåœ¨ä¸€ä¸ªå•ç‹¬çš„åŒ…ä¸­æä¾›äº†ä¸€ä¸ªé»˜è®¤ä¸»é¢˜ã€‚è¦ä½¿ç”¨å®ƒï¼Œæ‚¨éœ€è¦æ·»åŠ <b> instantsearch.css </b>æ ·å¼è¡¨ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘æƒ³ä½¿ç”¨<b><i>@ apply</i></b><i/>æŒ‡ä»¤ä¸æ‚¨ä¸€èµ·æ¢ç´¢ä¸€ä¸ªå®šåˆ¶çš„<b> Tailwindcss </b>ä¸»é¢˜ï¼Œè¯¥æŒ‡ä»¤å…è®¸æ‚¨ä½¿ç”¨TailwindCSSçš„é¢„å®šä¹‰ç±»åæ¥è®¾è®¡ä»»ä½•CSSé€‰æ‹©å™¨çš„æ ·å¼ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p>
<pre class="lang:css decode:true ">.ais-RefinementList ul {&#13;
  @apply flex font-normal text-sm flex-wrap gap-2 my-4;&#13;
}&#13;
&#13;
.ais-RefinementList ul li {&#13;
  @apply rounded bg-purple-200 px-2 py-1;&#13;
}&#13;
&#13;
.ais-RefinementList ul input {&#13;
  display: none;&#13;
}&#13;
&#13;
.ais-RefinementList-labelText {&#13;
  @apply font-medium text-purple-900;&#13;
}&#13;
&#13;
.ais-RefinementList-count {&#13;
  @apply font-black text-white p-1 px-1.5 bg-purple-400 rounded-full;&#13;
}&#13;
&#13;
.ais-RefinementList-item--selected {&#13;
  @apply border-2 border-purple-800;&#13;
}&#13;
&#13;
.aa-Panel mark {&#13;
  color: #5468ff;&#13;
  background: none;&#13;
}&#13;
</pre>
<p class="translated">ä¸€æ—¦æ·»åŠ äº†è¿™äº›æ ·å¼ï¼Œç»†åŒ–åˆ—è¡¨å°éƒ¨ä»¶åº”è¯¥å¤§è‡´å¦‚ä¸‹æ‰€ç¤º:</p>
<p class="translated"><video poster="https://res.cloudinary.com/hilnmyskv/image/upload/v1626861899/blogposts/store_locator_2021_refinementlist.jpg" autoplay="autoplay" loop="loop" muted="muted"> <source type="video/mp4" src="https://res.cloudinary.com/hilnmyskv/image/upload/v1626861899/blogposts/store_locator_2021_refinementlist.mp4"/> <source type="video/webm" src="https://res.cloudinary.com/hilnmyskv/image/upload/v1626861899/blogposts/store_locator_2021_refinementlist.webm"/> </video></p>
<h1 class="translated"><a id="displaying-stores-on-a-map-using-mapbox" class="anchor" href="#displaying-stores-on-a-map-using-mapbox" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>ä½¿ç”¨åœ°å›¾æ¡†åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºå•†åº—</h1>
<p class="translated">å¦‚æœä½ å·²ç»å®Œæˆäº†ï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºåœ¨è¿™ä¸ªé˜¶æ®µåº”è¯¥æ˜¯è¿™æ ·çš„:</p>
<p class="translated"><img loading="lazy" class="aligncenter wp-image-12486 size-full" src="../Images/e8a824887cc58eb60fd47e8d2b86ccc3.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image14.png 1999w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image14-273x178.png 273w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image14-614x400.png 614w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image14-768x500.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image14-1536x1000.png 1536w" sizes="(max-width: 1999px) 100vw, 1999px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image14.png"/></p>
<p class="translated">ä¸€ä¸ªé¡µçœ‰ï¼Œä¸€ä¸ªä¾§è¾¹çš„åˆ—è¡¨ï¼Œå’Œç©ºç™½çš„ç©ºé—´ã€‚ç°åœ¨æ˜¯æ—¶å€™ç”¨ä¸€å¼ æ¼‚äº®çš„åœ°å›¾æ¥å¡«æ»¡è¿™ä¸ªç©ºé—´äº†ï¼</p>
<h2 class="translated"><a id="choosing-the-right-map-provider" class="anchor" href="#choosing-the-right-map-provider" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>é€‰æ‹©åˆé€‚çš„åœ°å›¾æä¾›å•†</h2>
<p class="translated">æœ‰å‡ åä¸ªåœ°å›¾æä¾›å•†ï¼Œå…¶ä¸­ä¸€äº›éå¸¸æœ‰å:</p>
<ul>
<li class="translated">è°·æ­Œåœ°å›¾ï¼Œ</li>
<li class="translated">è‹¹æœè®¡åˆ’(ä»å»å¹´å¼€å§‹æœ‰ä¸€ä¸ªç½‘ç»œæ¡†æ¶)</li>
<li class="translated">åœ°å›¾æ¡†(æˆ‘ä»¬å°†ä½¿ç”¨çš„é‚£ä¸ª)</li>
<li class="translated">(ç”±è¯ºåŸºäºšå’Œæˆ´å§†å‹’é¢†å¯¼çš„è´¢å›¢â€”â€”æ¢…èµ›å¾·æ–¯-å¥”é©°ã€æ–¯ç›ç‰¹ã€å…‹è±æ–¯å‹’â€¦â€¦)</li>
<li class="translated">JawgMaps</li>
<li class="translated">å’Œä¼ å•(å¼€æº)</li>
</ul>
<p class="translated">é»˜è®¤æƒ…å†µä¸‹ï¼ŒAlgoliaçš„React InstantSearchåº“å†…ç½®äº†ä¸€ä¸ªç”¨äºè°·æ­Œåœ°å›¾çš„w<a href="https://www.algolia.com/doc/api-reference/widgets/geo-search/react/">id get</a>ã€‚ä¸è¿‡ï¼Œä¸ºäº†å‘æ‚¨å±•ç¤ºå¦‚ä½•é›†æˆä»»ä½•å…¶ä»–åœ°å›¾æä¾›å•†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a href="https://www.mapbox.com/use-cases/store-locator">Mapbox.com</a>æ„å»ºæˆ‘ä»¬æ–°çš„åœ°ç†æœç´¢å°éƒ¨ä»¶ï¼Œå› ä¸ºå®ƒä»¬æä¾›å¼ºå¤§çš„Reactå’ŒTypeScriptæ”¯æŒä»¥åŠå…¨çƒåœ°å›¾è¦†ç›–ã€‚</p>
<p class="translated">åœ¨æˆ‘ä»¬çš„ç¯å¢ƒä¸­ï¼ŒMapboxæœ‰ä¸€ä¸ªå·¨å¤§çš„é¢†åŸŸä¼˜åŠ¿:ä¸€ä¸ªæˆ‘ä»¬å°†åœ¨æœ¬ç³»åˆ—çš„ç¬¬ä¸‰é›†ä¸­ä½¿ç”¨çš„éå¸¸å®Œå–„çš„APIï¼ŒåŠ ä¸Šä»–ä»¬ä½¿ç”¨å¼€æºå †æ ˆçš„äº‹å®:</p>
<ul>
<li class="translated">æ¸²æŸ“å¼•æ“çš„ä¼ å•. js</li>
<li class="translated">OpenStreetMap (OSM)è·å–æ•°æ®</li>
<li class="translated">ç”¨äºè®¾è®¡çš„å¡é€š</li>
</ul>
<p class="translated">æ‰€ä»¥ä»Mapboxåˆ‡æ¢åˆ°å¦ä¸€ä¸ªæä¾›å•†åº”è¯¥ä¸ä¼šå¾ˆç—›è‹¦ã€‚</p>
<p class="translated"><img loading="lazy" class="aligncenter wp-image-12502 size-full" src="../Images/33e29cf099fca2343ae73707ebe9b5d2.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image30.png 1999w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image30-226x178.png 226w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image30-509x400.png 509w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image30-768x604.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image30-1536x1207.png 1536w" sizes="(max-width: 1999px) 100vw, 1999px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image30.png"/></p>
<p class="translated">åœ¨åˆ›å»ºäº†ä½ çš„åœ°å›¾ç®±è´¦æˆ·åï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼çš„ä¸œè¥¿ã€‚å¤åˆ¶æ‚¨çš„<code>Default Public Token</code>ï¼Œå¹¶å°†å…¶å¤åˆ¶åˆ°æ‚¨çš„<b> .local.env </b>æ–‡ä»¶ä¸­:</p>
<p class="translated"><code>REACT_APP_MAPBOX_TOKEN=pk.your_token_here</code></p>
<p class="translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡åœ¨ç»ˆç«¯ä¸­é”®å…¥æ¥å®‰è£…MapboxåŒ…è£…å™¨</p>
<p class="translated"><code>yarn add react-mapbox-gl mapbox-gl</code>T3ã€‘</p>
<p class="translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨<b>ç»„ä»¶</b>ä¸‹åˆ›å»ºä¸€ä¸ª<b> MapComponent </b>ç›®å½•ï¼Œå¹¶æ·»åŠ ä¸€ä¸ª<b> MapComponent.tsx </b>æ–‡ä»¶ã€‚</p>
<p class="translated">å¯¼å…¥æ‰€éœ€çš„åŒ…ï¼Œå¹¶æ­å»ºç±»ç»„ä»¶:</p>
<pre class="lang:js decode:true ">import React, { Component } from 'react';&#13;
import ReactMapboxGl, { ZoomControl, Marker } from 'react-mapbox-gl';&#13;
import { Map } from 'mapbox-gl';&#13;
&#13;
interface IMapState {&#13;
  lat: number;&#13;
  lng: number;&#13;
  zoom: number;&#13;
}&#13;
&#13;
interface IMapProps {}&#13;
&#13;
// Required to init the map&#13;
const ReactMap = ReactMapboxGl({&#13;
  accessToken: process.env.REACT_APP_MAPBOX_TOKEN as string,&#13;
});&#13;
&#13;
class MapComponent extends Component&lt;IMapProps, IMapState&gt; {&#13;
  map: any;&#13;
&#13;
  state = {&#13;
    lat: 30.5,&#13;
    lng: 50.5,&#13;
    zoom: 9,&#13;
  };&#13;
&#13;
  render() {&#13;
    return (&#13;
      &lt;div className={'h-full w-full relative'}&gt;&#13;
        &lt;div className={'h-full w-full'}&gt;&#13;
          &lt;ReactMap&#13;
            ref={(e) =&gt; {&#13;
              this.map = e.state.map;&#13;
            }}&#13;
            {/* This is the style, weâ€™ll use the light one but you can try street-v10 */}&#13;
            style="mapbox://styles/mapbox/light-v10"&#13;
            containerStyle={{&#13;
              height: '100%',&#13;
              width: '100%',&#13;
              position: 'relative',&#13;
              display: 'block',&#13;
           }}&#13;
          &gt;&#13;
            &lt;&gt;&#13;
           	//This adds a little +/- control to zoom in / out&#13;
      &lt;ZoomControl position={'bottom-right'} /&gt;&#13;
            &lt;/&gt;&#13;
          &lt;/ReactMap&gt;&#13;
        &lt;/div&gt;&#13;
      &lt;/div&gt;&#13;
    );&#13;
  }&#13;
}&#13;
&#13;
export default MapComponent;&#13;
</pre>
<p class="translated">ç”±äºreact-mapbox-glï¼Œæˆ‘ä»¬åˆšåˆšæ·»åŠ äº†ä¸€ä¸ªå…¨å°ºå¯¸åœ°å›¾ã€‚</p>
<p class="translated">é€šè¿‡åœ¨<b> App.tsx </b>ä¸­æ³¨å…¥æ‚¨æ–°åˆ›å»ºçš„ç»„ä»¶ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹ï¼Œæ‰€ä»¥ç°åœ¨æ˜¯æ·»åŠ æ ‡è®°çš„æ—¶å€™äº†ï¼</p>
<p class="translated">å‘ƒâ€¦ä¸ï¼é‚£å°±å¤ªç®€å•äº†ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ‚¨éœ€è¦å°†å®ƒæ·»åŠ åˆ°æ‚¨çš„craco.config.jsæ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶æ˜¯æˆ‘ä»¬ä¸Šå‘¨åˆ›å»ºçš„ï¼Œç”¨äºå¤„ç†PostCSSæ’ä»¶ã€‚</p>
<pre class="lang:json decode:true ">styles:{&#13;
//...postCSS stuff here&#13;
},&#13;
babel: {&#13;
    loaderOptions: {&#13;
      ignore: ['./node_modules/mapbox-gl/dist/mapbox-gl.js'],&#13;
    },&#13;
  },&#13;
</pre>
<p class="translated">npmä¸Šçš„<b> mapbox-gl </b>åº“å·²ç»è¢«ä¼ è¾“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å‘Šè¯‰babel(æˆ‘ä»¬çš„ä¼ è¾“ç¨‹åº)åˆ°<b>è€Œä¸æ˜¯</b>trans file map box-GL . js .<img loading="lazy" class="aligncenter wp-image-12487 size-full" src="../Images/685b40d2f8040f5a09e3cb4599aea8d4.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image15.png 1999w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image15-273x178.png 273w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image15-614x400.png 614w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image15-768x500.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image15-1536x1000.png 1536w" sizes="(max-width: 1999px) 100vw, 1999px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image15.png"/></p>
<p class="translated">ç°åœ¨æˆ‘ä»¬æ˜¾ç¤ºåœ°å›¾ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å®ƒçš„â€œåŠ¨æ€â€è¡Œä¸ºã€‚</p>
<h2 class="translated"><a id="creating-a-customwidget-with-connectgeosearch" class="anchor" href="#creating-a-customwidget-with-connectgeosearch" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a> <b>ä½¿ç”¨connectGeoSearchåˆ›å»ºè‡ªå®šä¹‰å°éƒ¨ä»¶</b></h2>
<p class="translated">ç°åœ¨æ˜¯æ—¶å€™å°†åœ°å›¾è¿æ¥åˆ°React InstantSearchå®ä¾‹äº†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨connectGeoSearchï¼Œè¿™æ˜¯React InstantSearchä¸­å…¬å¼€çš„ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ã€‚</p>
<p class="translated">è®©æˆ‘ä»¬å¯¼å…¥æ‰€éœ€çš„æ’ä»¶:</p>
<p class="translated"><code>import { connectGeoSearch } from 'react-instantsearch-dom';</code></p>
<p class="translated"><code>import type { GeoSearchProvided } from 'react-instantsearch-core';</code></p>
<p class="translated">ç¬¬ä¸€ä¸ªå¯¼å…¥åº“æœ¬èº«ï¼Œç¬¬äºŒä¸ªå¯¼å…¥TypeScriptå’ŒIntelliSenseæ‰€éœ€çš„ç±»å‹ã€‚</p>
<p class="translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç¨å¾®æ›´æ–°ä¸€ä¸‹æˆ‘ä»¬çš„MapComponentç±»å£°æ˜:</p>
<p class="translated"><code>class MapComponent extends Component&lt;<b>GeoSearchProvided &amp; IMapProps</b>, IMapState&gt;</code></p>
<p class="translated">æˆ‘ä»¬å°†ç¨å¾®æ”¹å˜å¯¼å‡ºç»„ä»¶çš„æ–¹å¼:</p>
<p class="translated"><code>export default connectGeoSearch(MapComponent)</code>ï¼›</p>
<p class="translated">åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬çš„åœ°å›¾æ¸²æŸ“ä¸ä¼šæœ‰ä»»ä½•å˜åŒ–<b>ä½†æ˜¯</b>å¦‚æœæˆ‘ä»¬æ‰“å¼€React DevToolså¹¶æœç´¢æˆ‘ä»¬çš„åœ°å›¾ç»„ä»¶ï¼Œå°±ä¼šæœ‰ä¸€äº›å˜åŒ–â€¦</p>
<p class="translated"><img loading="lazy" class="aligncenter wp-image-12507 size-full" src="../Images/1bf900526cd3b3525496667d6a02753e.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image35.png 1244w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image35-174x178.png 174w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image35-391x400.png 391w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image35-768x785.png 768w" sizes="(max-width: 1244px) 100vw, 1244px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image35.png"/></p>
<p class="translated">æˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬çš„MapComponentç°åœ¨æœ‰ä¸€ä¸ªåŒ…å«æ‰€æœ‰Algoliaç´¢å¼•è®°å½•çš„å±æ€§ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸“æ³¨äºåœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºé‚£äº›æ ‡è®°ã€‚</p>
<p class="translated">è®©æˆ‘ä»¬åœ¨çŠ¶æ€æ¥å£ä¸­æ·»åŠ ä¸€ä¸ªæ ‡è®°æ•°ç»„<code>marker: []</code>ï¼Œåœ¨å¡«å……æ¯ä¸ªå•†åº—çš„åæ ‡ä¹‹å‰ï¼Œæˆ‘ä»¬å°†å…¶åˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºæ•°ç»„..</p>
<p class="translated">ä¸ºäº†åœ¨ä»Algoliaæ¥æ”¶åˆ°æ–°çš„JSONå“åº”æ—¶æ›´æ–°æ˜¾ç¤ºçš„æ ‡è®°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Reactçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•<b> <code>componentWillReceiveProps</code> </b>ï¼Œå…¶ä¸­æˆ‘ä»¬å°†æ·»åŠ ä¸å‘åœ°å›¾æ·»åŠ æ ‡è®°ç›¸å…³çš„é€»è¾‘ã€‚</p>
<pre class="lang:js decode:true ">componentWillReceiveProps(nextProps){&#13;
// Letâ€™s grab hits from nextProps and letâ€™s compare if the two are not empty and differents from those already in props. 	 &#13;
    const { hits } = nextProps;&#13;
    if (hits.length &amp;&amp; hits !== this.props.hits) {&#13;
&#13;
	// If so letâ€™s grab coordinates from the hit and store them into an temp array&#13;
      const markers: [number, number][] = hits.map(&#13;
        ({ _geoloc }: { _geoloc: { lat: number; lng: number } }) =&gt; {&#13;
          return [_geoloc.lng, _geoloc.lat];&#13;
        }&#13;
      );&#13;
	&#13;
// Finally letâ€™s store this in our component state, and update the map accordingly (by centering it to the first marker) Weâ€™ll check this method in a minute, you can comment it for now.&#13;
      this.setState({ markers }, () =&gt; {&#13;
        //this.centerMapOnCoordinates(this.state.markers[0]);&#13;
      });&#13;
    }&#13;
}&#13;
</pre>
<p class="translated">ä¸ºäº†åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºæ ‡è®°ï¼Œè®©æˆ‘ä»¬åœ¨MapComponentç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª<StoreMarker/>ç»„ä»¶ã€‚è¿™ä¸€ä¸ªæœ‰1ä¸ªå±æ€§â€”<b>is selected</b>â€”â€”å¦‚æœå•†åº—è¢«é€‰ä¸­å°±æ”¹å˜æ ‡è®°ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘å°†åœ¨è¿™é‡ŒåŒ…æ‹¬å®ƒã€‚</p>
<pre class="lang:js decode:true ">import React from "react";&#13;
import { ReactComponent as MarkerPin } from '../../marker.svg';&#13;
import { ReactComponent as MarkerPinSelected } from '../../marker-selected.svg';&#13;
&#13;
const StoreMarker: React.FC&lt;{isSelected: boolean}&gt; = ({isSelected}) =&gt; {&#13;
  return isSelected ? &lt;MarkerPinSelected className={'shadow-lg cursor-pointer'}/&gt; : &lt;MarkerPin className={'shadow-lg cursor-pointer'}/&gt;;&#13;
}&#13;
&#13;
export default StoreMarker&#13;
</pre>
<p class="translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡å°†ç»„ä»¶åŒ…è£…åœ¨MapboxGL <Marker/>ç»„ä»¶ä¸­ï¼Œä¸ºç»„ä»¶å¢åŠ ä¸€å±‚é¢å¤–çš„å¤æ‚æ€§ã€‚å®ƒå°†è´Ÿè´£å‘åœ°å›¾æ·»åŠ æ ‡è®°ã€‚å®ƒåªéœ€è¦ä¸€ä¸ªé“å…·(å¯¹äºæˆ‘ä»¬çš„ä¾‹å­æ¥è¯´ï¼Œä½†è¿˜æœ‰ä¸€å †å¯ç”¨çš„):<b>åæ ‡:</b></p>
<pre class="lang:js decode:true ">â€¦&#13;
import {Marker} from "react-mapbox-gl";&#13;
&#13;
const StoreMarker: React.FC&lt;{isSelected: boolean, coordinates: [number, number]}&gt; = ({isSelected, coordinates}) =&gt; {&#13;
  return &lt;Marker coordinates={coordinates}&gt;&#13;
    {isSelected ? &lt;MarkerPinSelected className={'shadow-lg cursor-pointer'}/&gt; : &lt;MarkerPin className={'shadow-lg cursor-pointer'}/&gt;}&#13;
  &lt;/Marker&gt;&#13;
}&#13;
</pre>
<p class="translated">ç°åœ¨ï¼Œåœ¨MapComponentä¸­ï¼Œè®©æˆ‘ä»¬â€œæ˜ å°„â€æˆ‘ä»¬çš„æ ‡è®°ä»¥åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºå®ƒä»¬ï¼</p>
<pre class="lang:js decode:true ">MapComponent/MapComponent.tsx&#13;
&lt;&gt;&#13;
  {this.state.markers.map((position) =&gt; {&#13;
  return (&#13;
&lt;StoreMarker isSelected={false} coordinates={position}/&gt;&#13;
);&#13;
  })}&#13;
 &lt;ZoomControl position={'bottom-right'} /&gt;&#13;
&lt;/&gt;&#13;
</pre>
<p class="translated"><img loading="lazy" class="aligncenter wp-image-12497 size-full" src="../Images/0e5b7f3ecfb2955dc2bbfed33a8d3570.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image25.png 1999w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image25-273x178.png 273w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image25-614x400.png 614w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image25-768x500.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image25-1536x1000.png 1536w" sizes="(max-width: 1999px) 100vw, 1999px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image25.png"/></p>
<p class="translated">æˆ‘ä»¬ç°åœ¨åº”è¯¥æœ‰æ ‡è®°æ¸²æŸ“åœ¨æˆ‘ä»¬çš„åœ°å›¾ä¸Šã€‚</p>
<p class="translated">ç°åœ¨æ˜¯æ—¶å€™â€œæç‚¼â€è¿™ä¸ªï¼Œå¹¶åœ¨ç»™å®šçš„æ ‡è®°ä¸Šå°†åœ°å›¾å±…ä¸­ã€‚ä½†æ˜¯åœ¨ä»”ç»†è§‚å¯Ÿ<b> <code>centerMapOnCoordinates</code> </b>ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ·»åŠ å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ¥é¿å…æ— å…³çš„æ¸²æŸ“ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªæ˜¯æ£€æŸ¥ä¸¤ä¸ªå‘½ä¸­æ•°ç»„æ˜¯å¦ä¸åŒï¼Œå¹¶åœ¨ç›¸åçš„æƒ…å†µä¸‹é˜»æ­¢æ¸²æŸ“ã€‚</p>
<pre class="lang:js decode:true ">shouldComponentUpdate(nextProps: Readonly&lt;GeoSearchProvided&gt;): boolean {&#13;
    return nextProps.hits !== this.props.hits;&#13;
}&#13;
</pre>
<p class="translated">æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹<b> <code>centerMapOnCoordinates</code> </b>ã€‚è¿™å¯èƒ½æ˜¯æœ¬å‘¨éƒ¨åˆ†ä¸­æœ€å¤æ‚çš„ä»£ç ã€‚</p>
<p class="translated">æ³¨æ„:å¦‚æœæ‚¨æƒ³äº†è§£å…³äºä¸åŒæ­¥éª¤çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·ä¸è¦çŠ¹è±«è§‚çœ‹æœ¬æ–‡é¡¶éƒ¨çš„livecodingã€‚</p>
<p class="translated">æ‰€ä»¥è®©æˆ‘ä»¬åˆ†å¼€æ¥çœ‹:</p>
<p class="translated">å¦‚æœè°ƒç”¨æ˜¯ç”±åœ°å›¾ä¸Šçš„ç”¨æˆ·åŠ¨ä½œè§¦å‘çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨isUserInterractionçŠ¶æ€å¸ƒå°”æ¥é¿å…è¿›å…¥åœ°å›¾ã€‚</p>
<p class="translated">å¦‚æœä¸æ˜¯ï¼Œæˆ‘ä»¬æš‚æ—¶å°†å…¶è®¾ç½®ä¸ºtrueï¼Œå¹¶å°†åœ°å›¾é›†ä¸­åœ¨ç¬¬ä¸€ä¸ªæ ‡è®°ä¸Š(æ ¹æ®æˆ‘ä»¬çš„é…ç½®ï¼Œè¿™æ˜¯è§†å£ä¸­å…·æœ‰æœ€é«˜äººæ°”å±æ€§çš„å•†åº—)ã€‚</p>
<p class="translated">ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨é’©å­æä¾›çš„refineæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å…è®¸æˆ‘ä»¬åŸºäºåœ°å›¾è¾¹ç•Œè¯·æ±‚Algoliaçš„æ•°æ®:è¿™é‡Œæ˜¯ä¸œåŒ—å’Œè¥¿å—(å³ä¸Šå’Œå·¦ä¸‹)ã€‚</p>
<pre class="lang:js decode:true ">centerMapOnCoordinates(coordinates: [number, number]) {&#13;
    if (!this.state.isUserInteraction) {&#13;
      const { refine } = this.props;&#13;
      this.setState({ isUserInteraction: true }, () =&gt; {&#13;
        this.map.state.map.flyTo({&#13;
          essential: false,&#13;
          center: [coordinates[0], coordinates[1]],&#13;
          zoom: 7,&#13;
        });&#13;
&#13;
&#13;
        refine({&#13;
          northEast: this.map.state.map.getBounds().getNorthEast(),&#13;
          southWest: this.map.state.map.getBounds().getSouthWest(),&#13;
        });&#13;
      });&#13;
    }&#13;
  }&#13;
</pre>
<p class="translated"><img loading="lazy" class="aligncenter size-large wp-image-12493" src="../Images/42915710bff148595ef6a6412b137ae7.png" alt="" srcset="https://blog-api.algolia.com/wp-content/uploads/2021/07/image21-403x400.png 403w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image21-179x178.png 179w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image21-150x150.png 150w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image21-768x763.png 768w, https://blog-api.algolia.com/wp-content/uploads/2021/07/image21.png 1079w" sizes="(max-width: 403px) 100vw, 403px" data-original-src="https://blog-api.algolia.com/wp-content/uploads/2021/07/image21-403x400.png"/></p>
<h2 class="translated"><a id="add-%e2%80%9crefresh-as-the-map-moves%e2%80%9d-option-%c2%a0" class="anchor" href="#add-%e2%80%9crefresh-as-the-map-moves%e2%80%9d-option-%c2%a0" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a> <b>æ·»åŠ â€œéšç€åœ°å›¾ç§»åŠ¨è€Œåˆ·æ–°â€é€‰é¡¹ã€‚</b></h2>
<p class="translated">å½“æˆ‘ä»¬ç§»åŠ¨åœ°å›¾æ—¶ï¼Œè¿™ä¸ªåœ°å›¾ç»„ä»¶ä¸­éœ€è¦çš„æœ€åä¸€ä¸ªæ–¹æ³•å°†ç”¨äºç»†åŒ–åœ°å›¾æ ‡è®°ï¼è¿™æ˜¯ä¸€ä¸ªä¸è¨€è‡ªæ˜çš„æ–¹æ³•ã€‚æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†ä¹‹å‰åœ¨å®ƒçš„ä¸»ä½“ä¸­è°ƒç”¨çš„æ‰€æœ‰æ–¹æ³•ã€‚</p>
<pre class="lang:js decode:true ">onMapInteraction(map: Map) {&#13;
    if (this.state.userInteractionEnabled) {&#13;
      const { refine } = this.props;&#13;
&#13;
      refine({&#13;
        northEast: map.getBounds().getNorthEast(),&#13;
        southWest: map.getBounds().getSouthWest(),&#13;
      });&#13;
    }&#13;
  }&#13;
</pre>
<p class="translated">è¿™é‡Œå”¯ä¸€çš„æ–°å‚æ•°æ˜¯<b> <code>userInteractionEnabled</code> </b>å¸ƒå°”å€¼ï¼Œå®ƒæ ¹æ®æˆ‘ä»¬æ¥ä¸‹æ¥è¦æ·»åŠ çš„å¤é€‰æ¡†è€Œå˜åŒ–ï¼</p>
<p class="translated">ä¸ºäº†å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä½¿æˆ‘ä»¬çš„ä»£ç å°½å¯èƒ½æ¸…æ™°ï¼Œè®©æˆ‘ä»¬åœ¨MapComponent/ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚æˆ‘ä»¬å°†å†æ¬¡ç§°å®ƒä¸º<b> SearchAsMoving </b>ä»¥ä¿æŒæˆ‘ä»¬çš„ç»„ä»¶ç®€å•å’Œæ„šè ¢(KISSæ–¹æ³•è®º)ã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„divï¼Œå¸¦æœ‰ä¸€ä¸ªæ–‡æœ¬å’Œä¸€ä¸ª<code>input type=â€checkboxâ€</code></p>
<pre class="lang:js decode:true ">interface ISearchAsMoving {&#13;
  checked: boolean,&#13;
  onChange: (checked: boolean) =&gt; void&#13;
}&#13;
&#13;
const SearchAsMoving: React.FC&lt;ISearchAsMoving&gt; = ({checked, onChange}) =&gt; {&#13;
  return (&#13;
    &lt;div&gt;&#13;
      &lt;input&#13;
        defaultChecked={checked}&#13;
        type={'checkbox'}&#13;
        onChange={(e) =&gt;&#13;
          onChange(e.target.checked)&#13;
        }&#13;
      /&gt;&#13;
      Search when I move the map&#13;
    &lt;/div&gt;&#13;
  )&#13;
}&#13;
&#13;
export default SearchAsMoving&#13;
</pre>
<p class="translated">æˆ‘ä»¬å‘è¿™ä¸ªæ–¹æ³•ä¼ é€’ä¸¤ä¸ªå±æ€§ï¼Œé»˜è®¤çš„æ£€æŸ¥çŠ¶æ€(checked)å’Œå½“æˆ‘ä»¬æ”¹å˜å¤é€‰æ¡†çš„çŠ¶æ€æ—¶æˆ‘ä»¬æƒ³è¦è§¦å‘çš„æ–¹æ³•ã€‚</p>
<p class="translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥å°†å®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„åœ°å›¾ä¸­ï¼Œåœ¨<ReactMap/>ç»„ä»¶ä¸‹ï¼Œæˆ‘ä»¬ä¼šå¾ˆå¥½çš„ï¼</p>
<pre class="lang:js decode:true ">&lt;SearchAsMoving &#13;
    checked={this.state.userInteractionEnabled}   onChange={(userInteractionEnabled) =&gt; this.setState({userInteractionEnabled})}/&gt;&#13;
</pre>
<p class="translated">å®Œæˆåï¼Œè®©æˆ‘ä»¬å°†<b> <code>onMapInteraction</code> </b>æ·»åŠ åˆ°åœ°å›¾ä¸­ï¼Œè®©æˆ‘ä»¬ç»“æŸå§ï¼</p>
<pre class="lang:js decode:true ">&lt;ReactMap&#13;
            ref={(e) =&gt; { this.map = e?.state.map; }}&#13;
            style={...}&#13;
            containerStyle={{...}}&#13;
            onMoveEnd={this.onMapInteraction}&#13;
&gt;...&#13;
</pre>
<p class="translated"><video poster="https://res.cloudinary.com/hilnmyskv/image/upload/v1626774992/blogposts/store_locator_2021_map_preview.jpg" autoplay="autoplay" loop="loop" muted="muted"> <source type="video/mp4" src="https://res.cloudinary.com/hilnmyskv/image/upload/v1626774992/blogposts/store_locator_2021_map_preview.mp4"/> <source type="video/webm" src="https://res.cloudinary.com/hilnmyskv/image/upload/v1626774992/blogposts/store_locator_2021_map_preview.webm"/> </video></p>
<h2 class="translated"><a id="let%e2%80%99s-wrap-up" class="anchor" href="#let%e2%80%99s-wrap-up" aria-hidden="true"> <svg aria-hidden="true" class="octicon octicon-link" version="1.1" viewbox="0 0 16 16"> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/> </svg> </a>è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å§ï¼</h2>
<p class="translated">åŸºäºä¸Šå‘¨çš„å·¥ä½œ:</p>
<ul>
<li class="translated">æˆ‘ä»¬é¦–å…ˆä½¿ç”¨<instantsearch>å’Œ<hits>åŒ…è£…å™¨å°†æ•°æ®æ·»åŠ åˆ°è¾¹åˆ—è¡¨ä¸­</hits></instantsearch></li>
<li class="translated">æˆ‘ä»¬å·²ç»ç”¨<Configure/>ç»„ä»¶æ”¹è¿›äº†è¿™ä¸ªåˆ—è¡¨ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¼ é€’äº†â€˜aroundLatLngViaIPâ€™ä»¥ä¾¿å¾—åˆ°æˆ‘ä»¬å‘¨å›´çš„ç»“æœã€‚</li>
<li class="translated">æˆ‘ä»¬å·²ç»ä½¿ç”¨Mapboxåˆ›å»ºäº†ä¸€ä¸ªåœ°å›¾</li>
<li class="translated">æˆ‘ä»¬å·²ç»ä½¿ç”¨connectGeoSearch() HOCå°†å…¶è¿æ¥åˆ°React InstantSearchå®ä¾‹ã€‚</li>
<li class="translated">æœ€åï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæœç´¢ï¼Œå› ä¸ºæˆ‘ç§»åŠ¨åœ°å›¾å¤é€‰æ¡†ï¼Œä»¥æ”¹å–„æˆ‘ä»¬çš„UXã€‚</li>
</ul>
<p class="translated">æˆ‘ä»¬å°†åœ¨ç¬¬3éƒ¨åˆ†çœ‹åˆ°</p>
<ul>
<li class="translated">å¦‚ä½•æ·»åŠ å…è®¸æœç´¢ä½ç½®çš„è‡ªåŠ¨å®ŒæˆåŠŸèƒ½</li>
<li class="translated">å¦‚ä½•ä½¿ç”¨Twilioåœ¨å•†åº—æœ‰äº§å“æ—¶å‘é€æ–‡æœ¬æ¶ˆæ¯</li>
</ul>
<p class="translated"><span>æ³¨</span>:ä»Šå¤©ä¼šè¯çš„ä»£ç åœ¨<a href="https://github.com/algolia-samples/store-locator-with-algolia-mapbox-twilio/tree/session-2-adding-instant-search-end"> Githubåº“</a>ä¸­ã€‚</p>
</div></div>    
</body>
</html>